<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;direction:rtl;background:#f1f1f1;padding:20px;}
.card{background:white;padding:15px;border-radius:10px;margin-bottom:10px;}
.big{font-size:22px;font-weight:bold;}
</style>
</head>
<body>

<h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>

<div class="card">ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: <span class="big" id="count"></span></div>
<div class="card">ğŸ’° Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: <span class="big" id="subs"></span> Ø£ÙˆÙ‚ÙŠØ©</div>
<div class="card">ğŸ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø§Øª: <span class="big" id="aids"></span> Ø£ÙˆÙ‚ÙŠØ©</div>
<div class="card">ğŸ“Š Ø§Ù„Ø±ØµÙŠØ¯: <span class="big" id="balance"></span> Ø£ÙˆÙ‚ÙŠØ©</div>

<a href="index.html">â¬… Ø±Ø¬ÙˆØ¹</a>

<script>
let members = JSON.parse(localStorage.getItem("members") || "[]");

let totalSubs = 0;
let totalAids = 0;

members.forEach(m=>{
  m.subscriptions.forEach(s=> totalSubs += Number(s.amount));
  m.aids.forEach(a=> totalAids += Number(a.amount));
});

document.getElementById("count").innerText = members.length;
document.getElementById("subs").innerText = totalSubs;
document.getElementById("aids").innerText = totalAids;
document.getElementById("balance").innerText = totalSubs - totalAids;
</sfunction exportExcel(){
  let csv = "Ø§Ù„Ø§Ø³Ù…,Ø§Ù„Ø±Ù‚Ù…,Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª,Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø§Øª\n";

  members.forEach(m=>{
    let subs = m.subscriptions.reduce((s,x)=>s+Number(x.amount),0);
    let aids = m.aids.reduce((s,x)=>s+Number(x.amount),0);
    csv += `${m.name},${m.number},${subs},${aids}\n`;
  });

  let blob = new Blob([csv], { type: "text/csv" });
  let link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "takaful.csv";
  link.click();
}cript>
<button onclick="exportExcel()">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel</button>
</body>
</html>